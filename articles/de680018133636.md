---
title: "†二分探索†で怠惰なカーソル移動をしよう"
emoji: "🍣"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["vim", "neovim"]
published: false
---

# まえがき

ラベルとか見たり、検索して文字列を入力するのが面倒…
どれもなるべく少ないキー数で目的の場所に移動する事を目標としてる

マクロとか繰り返しを意識した場合ならまだしも通常時のカーソル移動なんぞ適当でいいし、脳のリソースを使いたくない
特に文字を認識するのがコスト高い

実際の所自分もカーソル移動(縦)の変異としては
1. `j`/`k`連打 or `8j` とかの数字付きを繰り返す
1. `{`/`}`で段落移動してから`j`/`k`で微調整
    とっかかりが無いと辛い
1. `H`/`L`で画面端に移動してから`j`/`k`で微調整

みたいな感じでざっくり移動してから微調整って感じが多い

雑プラグインを作ってみた

https://github.com/kamecha/bimove

# †二分探索カーソル移動†

さて、ここからが本題ですね
まずは実際の動作例を見たほうが話が早いです

![](https://storage.googleapis.com/zenn-user-upload/dcd451a41636-20251019.gif)

真ん中から徐々に範囲を絞っていって、最終的に目的の行に到達するイメージです
ハイライトがあると、大きなカーソルを徐々に小さくしながら動かしているような感覚になるやもですね。

## 二分探索って？
さて急に出てきた†二分探索†…←これなに
自分が初めて知ったのは競プロやってた時なんですが、ざっくり言うと
ソート済みの配列から探索範囲を半分づつ絞りながら目的の値を探すアルゴリズムです

## サブモードって何？
動作例では`MLLH...`みたいな感じで入力していましたが、
普通のキーバインドに慣れていると違和感があるかもしれないです。

巷で噂の†サブモード†とかいうのを利用しています。
Vim の機能として実装されているわけではなく、キーバンイドの設定を上手くする事で、
特定のキーを入力した後に一時的に別のキーバインドセットに切り替えるテクニックだと思っています。

今回の場合だと
- `M`を押すとカーソルを中央に移動して、†二分探索カーソル移動†モードに入る
- `H`を押すと探索範囲の上半分に絞る
- `L`を押すと探索範囲の下半分に絞る

という感じですね
サブモード中に対応しているキー以外のキーを押すとサブモードが自動解除されて、通常のキーと同様の動作になります。
なので、`MLL...`を入力している途中で`w`とかの通常のキーを押せば、サブモードが解除されて通常の`w`のカーソル移動になります。
また、`MLL...`を入力している途中で`M`を押すと一旦サブモードを解除して再度サブモードが開始します。

参考URL貼っとく
https://zenn.dev/mattn/articles/83c2d4c7645faa

# あとがき
vim におけるカーソル移動はかなりホットな話題なようで、様々なプラグインや設定が存在しています。
また定期的に話題にもなりますね。
今回は自分が良く使う`H` `M` `L`や、最近知ったサブモードを利用すれば、簡単に二分探索的なカーソル移動が実現できるんじゃね！？とか思い、ノリで実装してみました。
まぁ実際に使うかは別として、こういう発想もあるよねって感じで参考になれば幸いです。

